globalThis.disableIncrementalCache = false;globalThis.disableDynamoDBCache = false;globalThis.isNextAfter15 = true;globalThis.openNextDebug = false;globalThis.openNextVersion = "3.5.1";
var u=Object.defineProperty;var C=Object.getOwnPropertyDescriptor;var y=Object.getOwnPropertyNames;var N=Object.prototype.hasOwnProperty;var P=(t,a)=>{for(var e in a)u(t,e,{get:a[e],enumerable:!0})},E=(t,a,e,n)=>{if(a&&typeof a=="object"||typeof a=="function")for(let i of y(a))!N.call(t,i)&&i!==e&&u(t,i,{get:()=>a[i],enumerable:!(n=C(a,i))||n.enumerable});return t};var R=t=>E(u({},"__esModule",{value:!0}),t);var O={};P(O,{default:()=>f});module.exports=R(O);async function g(t,a,e){if(globalThis.openNextConfig.dangerous?.disableTagCache)return!1;if(!e.value)return!0;if("type"in e&&e.type==="page")return!1;let i=e.lastModified??Date.now();return globalThis.tagCache.mode==="nextMode"?await globalThis.tagCache.hasBeenRevalidated(a,i):await globalThis.tagCache.getLastModified(t,i)===-1}function x(t){if(!t)return[];try{return t.meta?.headers?.["x-next-cache-tags"]?.split(",")??[]}catch{return[]}}var A=new Set(["application/octet-stream","application/epub+zip","application/msword","application/pdf","application/rtf","application/vnd.amazon.ebook","application/vnd.ms-excel","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.openxmlformats-officedocument.wordprocessingml.document","font/otf","font/woff","font/woff2","image/bmp","image/gif","image/jpeg","image/png","image/tiff","image/vnd.microsoft.icon","image/webp","audio/3gpp","audio/aac","audio/basic","audio/flac","audio/mpeg","audio/ogg","audio/wavaudio/webm","audio/x-aiff","audio/x-midi","audio/x-wav","video/3gpp","video/mp2t","video/mpeg","video/ogg","video/quicktime","video/webm","video/x-msvideo","application/java-archive","application/vnd.apple.installer+xml","application/x-7z-compressed","application/x-apple-diskimage","application/x-bzip","application/x-bzip2","application/x-gzip","application/x-java-archive","application/x-rar-compressed","application/x-tar","application/x-zip","application/zip","application/x-protobuf"]);function m(t){if(!t)return!1;let a=t?.split(";")[0]??"";return A.has(a)}function h(t){try{return"__openNextInternal"in t}catch{return!1}}function c(...t){globalThis.openNextDebug&&console.log(...t)}function b(...t){console.warn(...t)}var B=[{clientName:"S3Client",commandName:"GetObjectCommand",errorName:"NoSuchKey"}],M=t=>B.some(a=>a.clientName===t?.clientName&&a.commandName===t?.commandName&&(a.errorName===t?.error?.name||a.errorName===t?.error?.Code));function T(...t){if(t.some(a=>M(a)))return c(...t);if(t.some(a=>h(a))){let a=t.find(e=>h(e));return a.logLevel<I()?void 0:a.logLevel===0?console.log(...t.map(e=>h(e)?`${e.name}: ${e.message}`:e)):a.logLevel===1?b(...t.map(e=>h(e)?`${e.name}: ${e.message}`:e)):console.error(...t)}console.error(...t)}function I(){switch((process.env.OPEN_NEXT_ERROR_LOG_LEVEL??"1").toLowerCase()){case"debug":case"0":return 0;case"error":case"2":return 2;default:return 1}}function L(t){return typeof t=="boolean"?t:typeof t=="object"?t.kindHint==="fetch"||t.fetchCache||t.kind==="FETCH":!1}var f=class{async get(a,e){if(globalThis.openNextConfig.dangerous?.disableIncrementalCache)return null;let n=typeof e=="object"?e.softTags:[],i=typeof e=="object"?e.tags:[];return L(e)?this.getFetchCache(a,n,i):this.getIncrementalCache(a)}async getFetchCache(a,e,n){c("get fetch cache",{key:a,softTags:e,tags:n});try{let i=await globalThis.incrementalCache.get(a,!0);if(i?.value===void 0)return null;let o=[...n??[],...e??[]],s=i.lastModified??Date.now();if(await g(a,o,i))return null;if((n??[]).length===0){let r=e?.find(p=>p.startsWith("_N_T_/")&&!p.endsWith("layout")&&!p.endsWith("page"));if(r&&await g(r.replace("_N_T_/",""),[],i))return null}return{lastModified:s,value:i.value}}catch(i){return c("Failed to get fetch cache",i),null}}async getIncrementalCache(a){try{let e=await globalThis.incrementalCache.get(a,!1);if(!e?.value)return null;let n=e.value,i=n.meta,o=x(n),s=e.lastModified??Date.now();if(await g(a,o,e))return null;let r=globalThis.__openNextAls.getStore();return r&&(r.lastModified=s),n?.type==="route"?{lastModified:s,value:{kind:globalThis.isNextAfter15?"APP_ROUTE":"ROUTE",body:Buffer.from(n.body??Buffer.alloc(0),m(String(i?.headers?.["content-type"]))?"base64":"utf8"),status:i?.status,headers:i?.headers}}:n?.type==="page"||n?.type==="app"?globalThis.isNextAfter15&&n?.type==="app"?{lastModified:s,value:{kind:"APP_PAGE",html:n.html,rscData:Buffer.from(n.rsc),status:i?.status,headers:i?.headers,postponed:i?.postponed}}:{lastModified:s,value:{kind:globalThis.isNextAfter15?"PAGES":"PAGE",html:n.html,pageData:n.type==="page"?n.json:n.rsc,status:i?.status,headers:i?.headers}}:n?.type==="redirect"?{lastModified:s,value:{kind:"REDIRECT",props:n.props}}:(b("Unknown cache type",n),null)}catch(e){return c("Failed to get body cache",e),null}}async set(a,e,n){if(globalThis.openNextConfig.dangerous?.disableIncrementalCache)return;let i=globalThis.__openNextAls.getStore()?.pendingPromiseRunner.withResolvers();try{if(e==null)await globalThis.incrementalCache.delete(a);else switch(e.kind){case"ROUTE":case"APP_ROUTE":{let{body:o,status:s,headers:l}=e;await globalThis.incrementalCache.set(a,{type:"route",body:o.toString(m(String(l["content-type"]))?"base64":"utf8"),meta:{status:s,headers:l}},!1);break}case"PAGE":case"PAGES":{let{html:o,pageData:s,status:l,headers:r}=e;typeof s=="string"?await globalThis.incrementalCache.set(a,{type:"app",html:o,rsc:s,meta:{status:l,headers:r}},!1):await globalThis.incrementalCache.set(a,{type:"page",html:o,json:s},!1);break}case"APP_PAGE":{let{html:o,rscData:s,headers:l,status:r}=e;await globalThis.incrementalCache.set(a,{type:"app",html:o,rsc:s.toString("utf8"),meta:{status:r,headers:l}},!1);break}case"FETCH":await globalThis.incrementalCache.set(a,e,!0);break;case"REDIRECT":await globalThis.incrementalCache.set(a,{type:"redirect",props:e.props},!1);break;case"IMAGE":break}await this.updateTagsOnSet(a,e,n),c("Finished setting cache")}catch(o){T("Failed to set cache",o)}finally{i?.resolve()}}async revalidateTag(a){let e=globalThis.openNextConfig.dangerous;if(!(e?.disableTagCache||e?.disableIncrementalCache))try{let n=Array.isArray(a)?a:[a];if(globalThis.tagCache.mode==="nextMode"){let i=await globalThis.tagCache.getPathsByTags?.(n)??[];await globalThis.tagCache.writeTags(n),i.length>0&&await globalThis.cdnInvalidationHandler.invalidatePaths(i.map(o=>({initialPath:o,rawPath:o,resolvedRoutes:[{route:o,type:"app"}]})));return}for(let i of n){c("revalidateTag",i);let o=await globalThis.tagCache.getByTag(i);c("Items",o);let s=o.map(r=>({path:r,tag:i}));if(i.startsWith("_N_T_/"))for(let r of o){let w=(await globalThis.tagCache.getByPath(r)).filter(d=>!d.startsWith("_N_T_/"));for(let d of w){let v=await globalThis.tagCache.getByTag(d);c({hardTag:d,_paths:v}),s.push(...v.map(_=>({path:_,tag:d})))}}await globalThis.tagCache.writeTags(s);let l=Array.from(new Set(s.filter(r=>r.tag.startsWith("_N_T_/")).map(r=>`/${r.path}`)));l.length>0&&await globalThis.cdnInvalidationHandler.invalidatePaths(l.map(r=>({initialPath:r,rawPath:r,resolvedRoutes:[{route:r,type:"app"}]})))}}catch(n){T("Failed to revalidate tag",n)}}async updateTagsOnSet(a,e,n){if(globalThis.openNextConfig.dangerous?.disableTagCache||globalThis.tagCache.mode==="nextMode"||!e)return;let i=e?.kind==="FETCH"?n?.tags??e?.data?.tags??[]:e?.kind==="PAGE"?e.headers?.["x-next-cache-tags"]?.split(",")??[]:[];c("derivedTags",i);let o=await globalThis.tagCache.getByPath(a),s=i.filter(l=>!o.includes(l));s.length>0&&await globalThis.tagCache.writeTags(s.map(l=>({path:a,tag:l,revalidatedAt:1})))}};
